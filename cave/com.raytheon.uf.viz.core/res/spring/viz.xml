<beans
  xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:context="http://www.springframework.org/schema/context"
  xmlns:util="http://www.springframework.org/schema/util"
  xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd   
  http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd
  http://www.springframework.org/schema/util
  http://www.springframework.org/schema/util/spring-util-2.5.xsd">
  
    <bean id="caveCredentialHandler" class="com.raytheon.uf.viz.core.comm.CaveHttpsCredentialsHandler" />
    
    <bean id="httpsConfiguration" class="com.raytheon.uf.viz.core.comm.HttpsConfiguration" />
    
	<bean id="httpClient" class="com.raytheon.uf.common.comm.HttpClient" factory-method="getInstance">
	   <property name="socketTimeout" value="330000"/>
	   <property name="connectionTimeout" value="10000"/>
	   <property name="maxConnectionsPerHost" value="10"/>
	   <property name="compressRequests" value="false"/>
	   <property name="gzipResponseHandling" value="false"/>	   
	   <property name="handler" ref="caveCredentialHandler" />
	   <property name="httpsConfiguration" ref="httpsConfiguration" />
	</bean>	

	<bean id="baosPool" class="com.raytheon.uf.common.util.ByteArrayOutputStreamPool" factory-method="getInstance">
	   <property name="maxPoolSize" value="8"/>
	   <property name="initStreamSize" value="1"/>
	   <property name="maxStreamSize" value="5.5"/>
	</bean>

   <bean id="vizMonitorHandler" class="com.raytheon.uf.viz.core.status.VizMonitorHandler">
      <property name="monitorEndpoint" value="edex.alerts.msg"/>
   </bean>

   <!-- FIXME: Uncomment to re-enable cache at CAVE startup
   <bean id="gfeDiskCache" class="com.raytheon.uf.common.cache.disk.DiskCache" init-method="activateCache">
      <property name="name" value="GFE"/>  -->
      <!-- TODO: Make this an environment variable that's passed in -->
      <!-- Cache directory relative to caveData/etc/workstation/${host} default is diskCache, will be followed by ${NAME}/${PID} -->
      <!--  <property name="baseCacheDir" value="diskCache"/>  -->
      <!-- Number of grids, to always allow in memory -->
      <!-- <property name="sizeMemCacheMap" value="150"/>
   </bean>  -->

   <bean class="com.raytheon.uf.common.geospatial.LogRedirector" factory-method="getInstance"/>
   
   <!-- These util:constant beans should not be required, they overwrite the ones in *-common.xml files for CAVE since
        CAVE just gets a ClassNotFoundException on boot... 
        someday the reason should be figured out and these beans removed -->
   <util:constant id="requestServerKey"
        static-field="com.raytheon.uf.common.auth.RequestConstants.REQUEST_SERVER" />
   
   <!-- Register routers -->
   <bean id="requestRouterRegistry"
        class="com.raytheon.uf.common.serialization.comm.RequestRouter"
        factory-method="getRouterRegistry" />

    <bean id="requestServiceRouter" class="com.raytheon.uf.viz.core.requests.ServerRequestRouter">
        <constructor-arg ref="requestServerKey" />
        <!-- This bean will cause all RequestRouter.route(request) calls to be serialized over to EDEX -->
    </bean>

    <bean factory-bean="requestRouterRegistry" factory-method="register">
        <constructor-arg ref="requestServerKey" />
        <constructor-arg ref="requestServiceRouter" />
    </bean>

</beans>