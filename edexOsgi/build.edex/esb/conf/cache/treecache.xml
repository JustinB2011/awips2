<?xml version="1.0" encoding="UTF-8"?>

<jbosscache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="urn:jboss:jbosscache-core:config:3.2">


    <!--
       isolation levels supported: READ_COMMITTED and REPEATABLE_READ
       nodeLockingSchemes: mvcc, pessimistic (deprecated), optimistic (deprecated)
    -->
    <locking
            isolationLevel="READ_COMMITTED"
            lockParentForChildInsertRemove="false"
            lockAcquisitionTimeout="20000"
            nodeLockingScheme="mvcc"
            writeSkewCheck="false"
            concurrencyLevel="500"/>

    <!--
    Used to register a transaction manager and participate in ongoing transactions.
    -->
    <transaction
            transactionManagerLookupClass="org.jboss.cache.transaction.GenericTransactionManagerLookup"
            syncRollbackPhase="false"
            syncCommitPhase="false"/>

    <!--
    Used to register JMX statistics in any available MBean server
    -->
    <jmxStatistics
            enabled="false"/>

    <!--
       If region based marshalling is used, defines whether new regions are inactive on startup.
    -->
    <startup
            regionsInactiveOnStartup="true"/>

    <!--
       Used to register JVM shutdown hooks.
       hookBehavior: DEFAULT, REGISTER, DONT_REGISTER
    -->
    <shutdown
            hookBehavior="DEFAULT"/>

    <!--
       Used to define async listener notification thread pool size
    -->
    <listeners
            asyncPoolSize="1"
            asyncQueueSize="1000000"/>

    <!--
       Used to enable invocation batching and allow the use of Cache.startBatch()/endBatch() methods.
    -->
    <invocationBatching
            enabled="false"/>
          
    <!--
       This element specifies that the cache is clustered.
       modes supported: replication (r) or invalidation (i).
    -->
    <clustering mode="invalidation" clusterName="EdexCache-cluster">

        <!--
           Defines whether to retrieve state on startup
        -->
        <stateRetrieval timeout="20000" fetchInMemoryState="false" nonBlocking="false"/>

        <!--
           Network calls are synchronous.
        -->
        <!--
        <sync replTimeout="20000"/>
        -->
        <!--
           Uncomment this for async replication.
        -->
        <async useReplQueue="false" serializationExecutorPoolSize="20" serializationExecutorQueueSize="5000000"/>

        <!--
           Configures the JGroups channel.  Looks up a JGroups config file on the classpath or filesystem.  udp.xml
           ships with jgroups.jar and will be picked up by the class loader.
        -->
        <jgroupsConfig>
             <UDP
                 mcast_addr="224.10.10.10"
                 mcast_port="${cache.mcast.port}"
                 tos="8"
         ucast_recv_buf_size="20M"
         ucast_send_buf_size="640K"
         mcast_recv_buf_size="25M"
         mcast_send_buf_size="640K"
         loopback="true"
                 discard_incompatible_packets="true"
         max_bundle_size="64K"
         max_bundle_timeout="30"
                 ip_ttl="2"
                 enable_bundling="true"
                 enable_diagnostics="true"
                 timer.num_threads="4"

                 thread_pool.enabled="true"
                 thread_pool.min_threads="2"
                 thread_pool.max_threads="8"
                 thread_pool.keep_alive_time="10000"
                 thread_pool.queue_enabled="true"
                 thread_pool.queue_max_size="100"
                 thread_naming_pattern="pl"
                 thread_pool.rejection_policy="Run"

                 oob_thread_pool.enabled="true"
                 oob_thread_pool.min_threads="1"
                 oob_thread_pool.max_threads="8"
                 oob_thread_pool.keep_alive_time="10000"
                 oob_thread_pool.queue_enabled="true"
                 oob_thread_pool.queue_max_size="100"
                 oob_thread_pool.rejection_policy="Run" 
                  />
            <PING timeout="2000"/>
            <MERGE2 max_interval="30000" min_interval="10000"/>
            <FD_SOCK stats="false"/>
            <VERIFY_SUSPECT timeout="5000"/>
    <pbcast.NAKACK use_stats_for_retransmission="false"
                   exponential_backoff="150"
                   use_mcast_xmit="true" gc_lag="25"
                   retransmit_timeout="300,600,1200,2400,3600"
                   discard_delivered_msgs="true"/>
            <UNICAST timeout="300,600,1200,2400,3600"/>
            <pbcast.STABLE desired_avg_gossip="50000" max_bytes="1M" stability_delay="1000"/>
            <pbcast.GMS join_timeout="10000" print_local_addr="true"
                        view_bundling="true"/>
            <FC max_credits="500K"
                    min_threshold="0.20"/>
            <FRAG2 frag_size="60K"/>
            <pbcast.STREAMING_STATE_TRANSFER/>
            <pbcast.FLUSH timeout="0"/>

        </jgroupsConfig>
    </clustering>
    

    
    <!--
       Eviction configuration.  WakeupInterval defines how often the eviction thread runs, in milliseconds.  0 means
       the eviction thread will never run.
    -->
    <!-- >eviction wakeUpInterval="500"-->
    <eviction wakeUpInterval="500">
        <default algorithmClass="org.jboss.cache.eviction.LRUAlgorithm" eventQueueSize="200000">
            <property name="maxNodes" value="1000"/>
            <property name="timeToLive" value="300000"/>
            <property name="minTimeToLive" value="0"/>
            <property name="maxAge" value="-1"/>
        </default>
         
    </eviction>

</jbosscache>
