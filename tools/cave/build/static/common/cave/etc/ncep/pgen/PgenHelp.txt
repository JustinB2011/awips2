PGEN - Product Generation

Product Generation, or PGEN, is the set of tools and techniques that allows the forecaster to draw and edit meteorological objects for creating graphical, text-based, and gridded products.

Upon entering PGEN, the user should choose what type of product or products they intend to develop. Multiple products may be managed simultaneously. Product types could be easily pre-defined.  For now, each product type could have its own configurable PGEN palette, settings table, layers and save mode.


Configure Product Types

Product types is a convenient way for the user to create and customize his own tools for using PGEN.  Once created, the user could start a specific product with a customized PGEN palette,  pre-populated layers,  pre-defined save mode,  and more.  Here is the way to do it:

1. Click "Configure" on the PGEN toolbar to start the configuration dialog

2. The dialog always starts with "New" type with only a few buttons pre-selected and colored blue.  All pre-defined types defined in "productTypes.xml" are loaded in the pull-down menu after "New" - CAVE first look for "productTypes.xml" in the local directory (where cave/eclipse starts); if not found, look in the "$AWIPS_BASE/eclipse/ncep/pgen/". 

3. Create a new type -  there are two ways to create a new product type:

(1). Select "New" -> type a name in the text box -> configure PGEN palette on the "Palette" page -> define layers in the "Layer" page ->  define save mode in the "Save" page -> click "Add".  

(2). Select an existing type -> edit its selections -> give a new name in the text box -> Click "Apply".
	
Note than the new type name cannot be any variations of "New" and the name of any existing types.  

4. Edit an existing type: select the type, edit its configurations and "Apply".

5. Delete an existing type: select the type, click "Delete" and confirm it.  Note, once a type is deleted, you cannot get it back (you can re-create it, though).

6. Exit the configuration: click either "Ok" or "Close".  "Ok" will save the changes to the current selected type (if it is "New" and no type name is given, then no save).  "Close" will not save changes. Upon exit, the PGEN palette will be reset to its default status.

7. Configure palette: click "Palette" tab -> select desired controls, actions, classes -> click on selected class button to see and select the objects for that class.

8. Define layers: click "Layer" tab -> give a name -> select its display mode, color mode (all colors or mono color), color, and filled mode -> define default input and output files (path and name) -> Click "Apply".  Defined layers will show up in the lower panel.  You can click on a layer name button to switch to it and edit its attributes. The green "Delete" button allows you to delete the current layer.  After 'Delete" a layer, you need to click "Apply" button at the bottom to confirm it.

9. Edit layers in a product type: Select the type -> click "Layer" tab -> edit the layers -> Click "Apply".

10. Define save mode: click "Save" tab -> define default file to save this product -> select if you want the layers to be saved individually -> Click "Apply",

11. Notes:

(1) When switching types by selecting from the pulldown menu, the selected controls/actions/classes on the "Palette" page will be highlighted as "blue" while those unselected will be colored "grey".  The PGEN palette will be updated with only selected buttons.

(2) There are a few controls/actions are always selected (cannot be unselected) and always show up in all types - it is controled by the "alwayVisible" attribute in the PGEN plugin.xml.  You can either set it to "false" or delete it if you do want to select/unselect a button in the configuration dialog.

(3) Select a class: click the check box to select then click the activated class name button to display/select the objects within that class (by default, all objects are selected for that class).  Notice that the title of the object group will be the name of the clicked class.

 


Product Management

Multiple products could be managed through the Product Manage Center as following:

1. Start a product - there are two ways to start a product:

(1) Standard Launch: Click the "Start" button on the PGEN toolbar to activate the product management center. Everything will be in default mode.

(2) Quick Launch: Click the little triangle at the right of the "Start" button to see all pre-defined product types and select one of the them to start the Product Management Center.  All definitions for that type will be populated for you.

2. Add a new product: Click "New" and a product attribute dialog pops up.  Enter a product name, select a product type and "Accept". 

3. Edit a product's attribute (name, type, save layers, output file name, etc.): first click a product's name button to make it active, then click again to pops up the product attribute window.  If an output file has been defined for that product type in its "save mode",  that file name should be here.  But you can change/overwrite it here.

4. Delete a product: Click "Delete", the current product is deleted. (if "Delete" is not shown, click ">>" at the bottom to expand the dialog).

5. Display/Hide a product: click the check box after the product name.

6. Change the type of a product: select from the type pull-down menu to select a new type. Empty existing layers will be removed. If an existing layer has the same name as one defined in the new product type, the layer' attributes will be updated. Layers in the new type with different names than existing layers' are attached as new layers.

7. Layering - the lower part functions the same as the legacy layering control for the active product.  However, if layers are predefined for that product type in its "layer",  those layers and their attributes are populated here.  You can add new layers or editing pre-defined layers. 

8. Exit product management - Click "Exit",  you will first be asked to save the products. After confirmation,  all products will be wiped off and the PGEN palette will be reset to its default state.

9. Save products - click "Save" on PGEN palette. Give a file name, e.g. A.xml, and click "Save".

(1) By default, all products are saved into a given file, e. g. "A.xml". If the "Post-save" box is checked, each product will be saved in its own file under "A_post/'product_name.xml" and layers are saved under "A_post/'product_name_post'/'layer_name'.xml. 

(2) If "Post-save" is off,  but a product's "Save Layers" is turned on, that product as well as its layers will be saved as structured in (1).

(3) If a product has its own output file name, it will be saved to that output file.  And if the product's "Save Layers" is also on, its layers are also saved along with the specified output file with the same structure outlined as in (1).

11. Open a product - Click "Open" on PGEN palette. Select a product file with one of three mode. If the file has multiple products or has one product but the product is not "Default", the product management dialog will be activated automatically.

(1) "Replace" - all existing products are removed and the products in the selected file are loaded in.

(2) "Append"  - Empty "Default" product is removed (if exists). Then all products in the selected file are added as separate products.

(3) "Merge" - Empty "Default" product is removed (if exists).  Then if a product's name AND type in the selected file match those in one of the existing products, layers in the new product are merged into the existing product. Otherwise, the product is added as a separate product.  When merging layers, if a layer have the same name as an existing layer's,  elements in the layer are moved into the existing layer.  Otherwise, it is added as a new layer.

With these options and rules, there is a wide variety of possibilities to create new products from some existing product files by manipulating their names, types, and layers' names.

12. Notes:    

(1) One file can hold multiple products and each product can have multiple layers.

(2) You can only work on one product and one layer at a time (active product's active layer).

(3) Default type: If a product's type is a non-existing product type,  "Default" is used. (E.g., create a product with one existing type and later that type is deleted from the "productTypes.xml").

(4) How does the new product management interacts with the legacy layering mechanism?

    The product management supersedes the layering control (layering is a built-in within the new product   management dialog).  However,  you can activate the layering control anytime - it will close the product management and start the layering dialog on the current product that is last set before the product management dialog closes.

(5) How does the new product management tool simulates the legacy NMAP Product Generation environment?
    
    Simply putting,  the legacy NMAP Product Generation environment is the simplest special case of the new product management tool - with only one "Default" product that has only one "Default" layer works behind the scene.  So without activating the tool explicitly ("Start" or open a product file with a non-default product or with multiple products),  everything works the same way as in the legacy PGEN.
 